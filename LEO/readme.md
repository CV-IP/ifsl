# LEO + IFSL

This project is based on the official code base of the paper [Meta-Learning with Latent Embedding Optimization](https://arxiv.org/abs/1807.05960).  This project includes a Tensorflow implementation of IFSL classifier in model.py. The class-wise mean features are available in pretrain folder.  

The backbone used in the official code release of LEO is not released. We used the pre-trained backbone provided [here](https://github.com/mileyan/simple_shot), which is also used to evaluate other meta-learning methods. Prior to training LEO, one needs to save the features generated by pre-trained network, which will be subsequently loaded during training. We provide the download link for pre-saved features of the backbone we used.

## Dependencies

Recommended version:
- TensorFlow 1.13
- TensorFlow Probability 0.5
- Sonnet 0.1.6
- Abseil

## Preparation

- Download the processed features at
  - https://drive.google.com/drive/folders/1uS3UMhg7v37orxx5f2X_nX8WTJg33EXT?usp=sharing
- In config.py, go to function load_ifsl_config and change checkpoint_path to where you want to store the trained model and change data_path to where you store the processed features

## Running Experiments

The following command will meta-train a model followed by meta-test.

```
# Training
python runner.py --config=mini_5_resnet_baseline
# Testing
python runner.py --config=mini_5_resnet_baseline --evaluation_mode=True
```

Please refer to ifsl_configs folder for the complete list of configurations.

To perform CUB test, add --cross option.

